---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import PostCard from '../../components/PostCard.astro';

export async function getStaticPaths() {
  const allPosts = await getCollection('blog');
  const uniqueCategories = [...new Set(allPosts.map((post) => 
    (post.data.category || 'general').toLowerCase().trim()
  ))];

  return uniqueCategories.map((cat) => {
    const filteredPosts = allPosts.filter((post) => 
      (post.data.category || 'general').toLowerCase().trim() === cat
    );
    return {
      params: { categoria: cat },
      props: { posts: filteredPosts, categoryName: cat },
    };
  });
}

const { posts, categoryName } = Astro.props;
---

<Layout title={`Explorando ${categoryName}`}>
  <header class="mb-12 border-b border-slate-200 pb-8">
    <a href="/" class="text-indigo-600 font-medium text-sm hover:underline">← Volver al inicio</a>
    <h1 class="text-4xl font-extrabold text-slate-900 capitalize mt-4">
      {categoryName}
    </h1>
    <p class="text-slate-500 mt-2 text-lg ">
      Artículos y experimentos relacionados con la física de la categoría: <strong class="text-indigo-600 capitalize">{categoryName}</strong>.
    </p>
  </header>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
    {posts.map((post) => (
      <PostCard post={post} />
    ))}
  </div>

  {posts.length === 0 && (
    <div class="text-center py-20 bg-white rounded-3xl border border-dashed border-slate-300">
      <p class="text-slate-400">Aún no hay experimentos en esta sección. ¡Pronto Gemini nos traerá algo!</p>
    </div>
  )}
</Layout>